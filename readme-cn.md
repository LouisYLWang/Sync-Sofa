# Sync Sofa - åœ¨çº¿è§†é¢‘åŒæ­¥æ’­æ”¾æ’ä»¶

> ä»¥ç¨³å®šï¼Œå¿«æ·çš„æ–¹å¼è¿œç¨‹åŒæ­¥è§‚çœ‹åœ¨çº¿/æœ¬åœ°è§†é¢‘

![GitHub go.mod Go version (subfolder of monorepo)](https://img.shields.io/github/go-mod/go-version/LouisYLWang/Sync-Sofa?filename=server%2Fgo.mod&style=flat-square) [![Chrome web store users][chrome-image]][chrome-url]

Sync Sofaæ˜¯ä¸€ä¸ªç¨³å®šæ˜“ç”¨çš„Chromeæµè§ˆå™¨æ‹“å±•æ’ä»¶ï¼Œå¯åŒæ­¥ä¸¤ç«¯ç”¨æˆ·çš„è§†é¢‘æ’­æ”¾æ“ä½œï¼Œæé«˜ä¸èº«å¤„å¼‚åœ°çš„å°ä¼™ä¼´ä¸€åŒè§‚çœ‹è§†é¢‘çš„ä½“éªŒï¼Œç›®å‰æ”¯æŒä»¥ä¸‹ä¸»è¦åŠŸèƒ½ï¼š

- å¹³ç­‰åŒäººè¿æ¥ï¼šä»»æ„ä¸€ç«¯å‡å¯æ§åˆ¶å¯¹æ–¹æ’­æ”¾çŠ¶æ€
- åŒæ­¥æ’­æ”¾è¿›åº¦ï¼šæ”¯æŒæ’­æ”¾ã€æš‚åœã€è¿›åº¦åˆ‡æ¢ç­‰æ“ä½œ
- æœ¬åœ°è§†é¢‘åŒæ­¥ï¼šå¯é€šè¿‡VLCåŒæ­¥æœ¬åœ°è§†é¢‘æ’­æ”¾çŠ¶æ€

## å½“å‰ç‰ˆæœ¬ç‰¹æ€§:

**v1.0.7 - 2020å¹´7æœˆ5æ—¥æ›´æ–°**

âš âš âš  æ³¨æ„ï¼Œæ­¤ç‰ˆæœ¬ä¸<= 1.0.5çš„ä»»ä½•ç‰ˆæœ¬éƒ½ä¸å…¼å®¹ï¼Œè¯·åŠ¡å¿…ç¡®ä¿ä½ çš„ç‰ˆæœ¬ä¸å°ä¼™ä¼´çš„ç‰ˆæœ¬ä¸€è‡´ã€‚

- æ–°å¢åŠŸèƒ½ï¼š
    - æ–°å¢ç‰ˆæœ¬æ£€æµ‹ï¼ˆé«˜ç‰ˆæœ¬ç”¨æˆ·ä¸ä½ç‰ˆæœ¬ç”¨æˆ·è¿æ¥æ—¶ï¼Œè‹¥è¿æ¥ç ç”±ä½ç‰ˆæœ¬ç”¨æˆ·ç”³è¯·ï¼Œé«˜ç‰ˆæœ¬ç”¨æˆ·å°†æ”¶åˆ°æç¤ºï¼Œè¯·æ ¹æ®æç¤ºå‘ŠçŸ¥å¯¹æ–¹å‡çº§æœ€æ–°ç‰ˆæœ¬ï¼‰
- ä¿®å¤åŠŸèƒ½:
    - ä¿®å¤å¯¹ [bilibili movie](https://www.bilibili.com/bangumi/*) çš„æ”¯æŒ
    - ä¿®å¤äº†ä¼˜é…·åŠèŠ’æœTVæ— æ³•åŒæ­¥æ“ä½œçš„é—®é¢˜

---

## æ”¯æŒç½‘ç«™åˆ—è¡¨

* [çˆ±å¥‡è‰º](https://www.iqiyi.com/) 
* [ä¼˜é…·](https://www.youku.com/)
* [å¾®äº‘](https://www.weiyun.com/)
* [è…¾è®¯è§†é¢‘](https://v.qq.com/)
* [æ²¹ç®¡](https://www.youtube.com/)
* [èŠ’æœ](https://www.mgtv.com/)
* é€šè¿‡æµè§ˆå™¨æ’­æ”¾æœ¬åœ°è§†é¢‘ï¼ˆä»…æ”¯æŒAVC/H.264ç¼–ç ï¼‰
* [é€šè¿‡VLCè§†é¢‘æ’­æ”¾å™¨æ’­æ”¾æœ¬åœ°è§†é¢‘](https://www.videolan.org/vlc/index.html)

[ç‚¹å‡»è¿™é‡Œå‘æˆ‘ä»¬åé¦ˆæ›´å¤šç½‘ç«™](https://github.com/LouisYLWang/Sync-Sofa/issues/22)

## è®¾ç½®

ğŸ˜Š æ­¤éƒ¨åˆ†ä¸ºå¯é€‰è®¾ç½®ï¼Œæˆ‘ä»¬å·²ç»ä¸ºä½ é…ç½®å¥½é»˜è®¤æœåŠ¡å™¨ï¼Œå¦‚æœä½ ä¸æ„Ÿå…´è¶£ï¼Œæˆ–è€…æ²¡æœ‰ä¿®æ”¹æœåŠ¡å™¨çš„éœ€æ±‚ï¼Œè¯·ç§»æ­¥è‡³[ä¸‹ä¸€éƒ¨åˆ†](#usage).

### æœåŠ¡å™¨åˆ—è¡¨

æœ€è¿‘è®¸å¤šç”¨æˆ·åæ˜ å›½å†…çš„è®¿é—®ä¸ç¨³å®šï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬çš„é»˜è®¤æœåŠ¡å™¨åœ¨ç¾å›½ï¼Œå› æ­¤æˆ‘ä»¬æä¾›äº†å¤‡ç”¨æœåŠ¡å™¨åˆ—è¡¨ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„ä½ç½®åˆ‡æ¢åˆ°ç¦»ä½ è·ç¦»æ›´è¿‘çš„æœåŠ¡å™¨ã€‚

* https://app.ylwang.me (ç¾å›½)
* https://sync-cn.onns.xyz (å›½å†…)

åœ¨è®¾ç½®æœåŠ¡å™¨å‰ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨çš„çŠ¶æ€ï¼š[https://sync-status.onns.xyz/](https://sync-status.onns.xyz/).

æˆ‘ä»¬ä¼šæ„Ÿè°¢ä½ å¯¹è¯¥å¼€æºé¡¹ç›®ä½œå‡ºçš„è´¡çŒ®ï¼Œä½ å¯ä»¥é€šè¿‡**æä¾›è‡ªå·±éƒ¨ç½²çš„æœåŠ¡**æ¥æ”¯æŒæˆ‘ä»¬ï¼Œä¹Ÿå¯ä»¥å¸®æˆ‘ä»¬**åˆ†æ‹…ä¸€ç‚¹æœåŠ¡å™¨è´¹ç”¨**çš„å‹åŠ›ã€‚ï¼ˆ~~ä¹Ÿå¯ä»¥ä¸€é”®ä¸‰è¿~~ï¼‰

**æ”¯ä»˜å®, å¾®ä¿¡æ”¯ä»˜, è´å®**

![alipay](https://onns.xyz/blog/image/20200704-1.png) ![wechat pay](https://onns.xyz/blog/image/20200704-2.png) ![paypal](https://onns.xyz/blog/image/20200704-3.jpg)

### é€‰é¡¹é¡µ

æ‰“å¼€é€‰é¡¹é¡µæœ‰ä¸‹åˆ—ä¸¤ç§æ–¹æ³•ï¼š

1. å³é”®ç‚¹å‡»`Sync Sofa`æ’ä»¶å›¾æ ‡, é€‰æ‹©`é€‰é¡¹`ã€‚
2. å·¦é”®ç‚¹å‡»`Sync Sofa`æ’ä»¶å›¾æ ‡, åœ¨æ’ä»¶å¼¹çª—ä¸­é€‰æ‹©åº•éƒ¨`è®¾ç½®`å›¾æ ‡ã€‚

è®¾ç½®ç•Œé¢å¦‚ä¸‹ï¼š

![Sync Sofa - Options](https://onns.xyz/blog/image/20200629-3.png)

### åˆ·æ–°è§†é¢‘é¡µé¢

ä¿®æ”¹è®¾ç½®å¹¶ä¿å­˜åï¼Œè¯·åˆ·æ–°è§†é¢‘ç½‘ç«™é¡µé¢/æœ¬åœ°è§†é¢‘é¡µé¢/ [http://127.0.0.1:8080/](http://127.0.0.1:8080/)ï¼ˆå¦‚æœä½ ä½¿ç”¨VLCæ’­æ”¾æœ¬åœ°è§†é¢‘ï¼‰æ¥ä½¿è®¾ç½®ç”Ÿæ•ˆã€‚



## ä½¿ç”¨è¯´æ˜

### æ³¨æ„äº‹é¡¹

âš ï¸ ä½¿ç”¨å‰è¯·ç¡®ä¿ä¸¤ä¸ª`å®¢æˆ·ç«¯ç‰ˆæœ¬å·`ä¸€è‡´ã€‚

âš ï¸ ä½¿ç”¨å‰è¯·ç¡®ä¿ä¸¤ä¸ª`æœåŠ¡å™¨åŸŸå`ä¸€è‡´ã€‚

âš ï¸ å¦‚éœ€æ’­æ”¾æœ¬åœ°`.mp4`æ–‡ä»¶ï¼Œè¯·åœ¨æ‰©å±•è¯¦ç»†ä¿¡æ¯é¡µé¢å¯ç”¨â€œå…è®¸è®¿é—®æ–‡ä»¶urlâ€ã€‚


æ–¹æ³•1. åœ¨åœ°å€æ è¾“å…¥`chrome://extensions/`ï¼Œæ‰¾åˆ°`Sync Sofa`ï¼Œç‚¹å‡»`è¯¦æƒ…`æŒ‰é’®ï¼Œå¯ç”¨`å…è®¸è®¿é—®æ–‡ä»¶ç½‘å€`ã€‚

æ–¹æ³•2.å³å‡»æµè§ˆå™¨å·¦ä¸Šè§’`Sync Sofa`å›¾æ ‡ï¼Œé€‰æ‹©`ç®¡ç†æ‹“å±•ç¨‹åº`, å¯ç”¨`å…è®¸è®¿é—®æ–‡ä»¶ç½‘å€`ã€‚

âš ï¸ å¦‚æœä½ çš„æµè§ˆå™¨ä¸­å®‰è£…äº†`å¤šä¸ªä¸åŒç‰ˆæœ¬`çš„`Sync Sofa`,è¯·åªå¯ç”¨å…¶ä¸­ä¸€ä¸ªå¹¶ç¦ç”¨å…¶ä»–ç‰ˆæœ¬ã€‚


### æ‰“å¼€è§†é¢‘é¡µé¢

ä½ ä»¬å¯ä»¥åŒæ­¥è§‚çœ‹ä¸åŒæ¥æºçš„è§†é¢‘ï¼Œåœ¨æ’­æ”¾æœ¬åœ°`.mp4`è§†é¢‘æ–‡ä»¶æ—¶ï¼Œä½ çš„å°ä¼™ä¼´å¯ä»¥é€‰æ‹©åœ¨è§†é¢‘ç½‘ç«™ä¸Šå’Œä½ åŒæ­¥è§‚çœ‹ï¼Œæ­¤å¤–ï¼Œä½ ä»¬è¿˜å¯ä»¥åœ¨ä¸åŒçš„è§†é¢‘ç½‘ç«™çœ‹è§‚çœ‹ç›¸åŒçš„è§†é¢‘ã€‚


ä¾‹å¦‚ï¼Œ`ç”¨æˆ·A`åœ¨Bilibiliä¸Šè§‚çœ‹æ­¤è§†é¢‘ï¼š
* [https://www.bilibili.com/video/BV1k5411Y7Rc](https://www.bilibili.com/video/BV1k5411Y7Rc)
![User A](https://onns.xyz/blog/image/20200627-1.png)

æ­¤æ—¶`ç”¨æˆ·B`å¯åœ¨YouTubeä¸ŠåŒæ­¥è§‚çœ‹åŒä¸€è§†é¢‘ï¼š
* [https://www.youtube.com/watch?v=QAelMP1PoNA](https://www.youtube.com/watch?v=QAelMP1PoNA)
![User B](https://onns.xyz/blog/image/20200627-2.png)

å¦‚æœè§†é¢‘å¼€å§‹å‰æœ‰å¹¿å‘Šï¼Œè¯·åœ¨å¹¿å‘Šç»“æŸåè¿›å…¥ä¸‹ä¸€æ­¥ã€‚

### è·å–è¿æ¥ç 

ç‚¹å‡» `Sync Sofa` æ’ä»¶å›¾æ ‡å¹¶ç‚¹å‡»`REQUEST NEW CODE`ï¼ˆè·å–é“¾æ¥ç ï¼‰ æŒ‰é’®.

![User A](https://onns.xyz/blog/image/20200627-3.png)


å¦‚ä¸€åˆ‡æ­£å¸¸ï¼Œä½ ä¼šæ”¶åˆ°å¼¹çª—æç¤º`Room created and room code copied to clipboard` ï¼ˆæˆ¿é—´å·²å»ºç«‹ï¼Œè¿æ¥ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼‰ï¼ŒåŒæ—¶`è¿æ¥ç `å°†è‡ªåŠ¨æ‹·è´åˆ°å‰ªåˆ‡æ¿ä¸­ï¼Œè¯·å°†å®ƒå‘ç»™ä½ çš„å°ä¼™ä¼´ã€‚

### å¼€å§‹è¿æ¥

ä½ çš„å°ä¼™ä¼´æ”¶åˆ°`room codeï¼ˆè¿æ¥ç ï¼‰`åï¼Œç‚¹å‡»`Sync Sofa`æ’ä»¶å›¾æ ‡ï¼Œç²˜è´´åˆ°è¾“å…¥æ ä¸­ç‚¹å‡»`STARTï¼ˆå¼€å§‹ï¼‰`æŒ‰é’®ã€‚

![User B](https://onns.xyz/blog/image/20200627-4.png)

### æ„‰å¿«è§‚çœ‹å§
![User A](https://onns.xyz/blog/image/20200627-5.png)
![User B](https://onns.xyz/blog/image/20200627-6.png)


ç°åœ¨ä½ å¯ä»¥æ’­æ”¾è§†é¢‘äº†ï¼Œä½ çš„æ’­æ”¾ï¼Œæš‚åœï¼Œæ›´æ”¹æ—¶é—´ç­‰æ“ä½œéƒ½ä¼šåŒæ­¥ç»™ä½ çš„å°ä¼™ä¼´ã€‚æ„‰å¿«åœ°åŒæ­¥è§‚çœ‹å§!

## VLCæ”¯æŒ
å¦‚æœä½ ä»¬éƒ½é€šè¿‡`VLC åª’ä½“æ’­æ”¾å™¨`æ’­æ”¾è§†é¢‘ï¼Œ`Sync Sofa`ä¹Ÿå¯ä»¥åŒæ­¥ä½ ä»¬çš„æ“ä½œã€‚

### é€šè¿‡Webæ§åˆ¶ç•Œé¢æ“æ§VLCæ’­æ”¾
é¦–å…ˆä½ ä»¬éœ€è¦å¼€å¯VLCçš„Webæ§åˆ¶ç•Œé¢ï¼Œä½¿æµè§ˆå™¨å¯ä»¥æ§åˆ¶VLCçš„æ’­æ”¾ï¼Œè¯·å‚è€ƒä»¥ä¸‹å®˜æ–¹æ–‡æ¡£ï¼š
* [é€šè¿‡æµè§ˆå™¨æ§åˆ¶VLC](https://wiki.videolan.org/Control_VLC_via_a_browser/)
* [å¼€å¯VLCçš„webæ§åˆ¶ç•Œé¢](https://wiki.videolan.org/Documentation:Modules/http_intf/#VLC_2.0.0_and_later)

1. æ‰“å¼€VLCåª’ä½“æ’­æ”¾å™¨
2. è¿›å…¥ `å·¥å…· â†’ åå¥½è®¾ç½® (å·¦ä¸‹è§’æ˜¾ç¤ºè®¾ç½®é€‰æ‹© "å…¨éƒ¨") â†’ ç•Œé¢ â†’ ä¸»ç•Œé¢`, å‹¾é€‰ "Web"
  ![Step 2](https://onns.xyz/blog/image/20200628-1.png)
3. è¿›å…¥ `å·¥å…· â†’ åå¥½è®¾ç½® (å·¦ä¸‹è§’æ˜¾ç¤ºè®¾ç½®é€‰æ‹© "å…¨éƒ¨") â†’ ç•Œé¢ â†’ ä¸»ç•Œé¢ â†’ Lua`, è®¾ç½® `Lua HTTP - å¯†ç `
  ![Step 3](https://onns.xyz/blog/image/20200628-2.png)
4. ç‚¹å‡»`ä¿å­˜` å¹¶é‡å¯VLCåª’ä½“æ’­æ”¾å™¨
5. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ [http://127.0.0.1:8080/](http://127.0.0.1:8080/) 

è¿™æ—¶ä½ çš„ç½‘é¡µåº”è¯¥å¦‚ä¸‹å›¾æ‰€ç¤º:

![VLC media player - Web Interface](https://onns.xyz/blog/image/20200628-3.png)

### è·å–è¿æ¥ç 
ç¡®è®¤å·²åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ [http://127.0.0.1:8080/](http://127.0.0.1:8080/),
ç‚¹å‡» `Sync Sofa` æ’ä»¶å›¾æ ‡å¹¶ç‚¹å‡»`REQUEST NEW CODE`ï¼ˆè·å–é“¾æ¥ç ï¼‰ æŒ‰é’®.

å¦‚ä¸€åˆ‡æ­£å¸¸ï¼Œä½ ä¼šæ”¶åˆ°å¼¹çª—æç¤º`Room created and room code copied to clipboard`ï¼ˆæˆ¿é—´å·²å»ºç«‹ï¼Œè¿æ¥ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ŒåŒæ—¶`è¿æ¥ç `å°†è‡ªåŠ¨æ‹·è´åˆ°å‰ªåˆ‡æ¿ä¸­ï¼Œè¯·å°†å®ƒå‘ç»™ä½ çš„å°ä¼™ä¼´ã€‚

### å¼€å§‹è¿æ¥

ä½ çš„å°ä¼™ä¼´æ”¶åˆ°`room code`åï¼Œç‚¹å‡»`Sync Sofa`æ’ä»¶å›¾æ ‡ï¼Œç²˜è´´åˆ°è¾“å…¥æ ä¸­ç‚¹å‡»`START`ï¼ˆå¼€å§‹ï¼‰æŒ‰é’®ã€‚

### æ„‰å¿«è§‚çœ‹å§

ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨`Sync Sofa`é€šè¿‡VLCåŒæ­¥æœ¬åœ°è§†é¢‘æ’­æ”¾çŠ¶æ€äº†ï¼Œä½ çš„æ’­æ”¾ï¼Œæš‚åœï¼Œæ›´æ”¹æ—¶é—´ç­‰æ“ä½œéƒ½ä¼šåŒæ­¥ç»™ä½ çš„å°ä¼™ä¼´ã€‚æ„‰å¿«åœ°åŒæ­¥è§‚çœ‹å§!


**æ³¨æ„**:


âš ï¸ åœ¨æ’­æ”¾æ—¶ï¼Œåˆ‡å‹¿å…³é—­[http://127.0.0.1:8080/](http://127.0.0.1:8080/)é¡µé¢ã€‚

### å…³é—­æ§åˆ¶é¡µé¢

è§†é¢‘æ’­æ”¾å®Œæ¯•åï¼Œç‚¹å‡»`Sync Sofa`æ’ä»¶é¡µé¢ä¸Šçš„`STOP`æŒ‰é’®ï¼Œæˆ–å…³é—­[http://127.0.0.1:8080/](http://127.0.0.1:8080/)é¡µé¢ã€‚

## å®‰è£…

### Google Chrome

#### ä»è°·æ­Œå•†åº—å®‰è£…

1. åœ¨Chromeæµè§ˆå™¨ä¸­æ‰“å¼€ [Sync Sofa - Online Video Synchronizer - Chrome Web Store](https://chrome.google.com/webstore/detail/sync-sofa-online-video-sy/kgpnhgmpijhpkefpddoehhminpfiddmg) 
2. ç‚¹å‡» `Add to Chrome` æŒ‰é’®
3. é€‰æ‹© `Add extension`

#### ä»æœ¬åœ° .crx æ–‡ä»¶å®‰è£…

1. æ‰“å¼€ [Github release pageï¼ˆç‰ˆæœ¬å‘å¸ƒé¡µé¢ï¼‰](https://github.com/LouisYLWang/Sync-Sofa/releases/latest)
2. ä¸‹è½½ `sync_sofa.[version].crx`, *[version]* ä¸ºå½“å‰æœ€æ–°ç‰ˆæœ¬ç¼–å·
3. åœ¨Chromeæµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ `chrome://extensions/` 
4. å¯ç”¨ `å¼€å‘è€…æ¨¡å¼` (é¡µé¢å³ä¸Šè§’)
5. å°† `sync_sofa.[ç‰ˆæœ¬å·].crx` æ‹–å…¥ `chrome://extensions/` é¡µé¢
6. ç‚¹å‡» `æ·»åŠ æ’ä»¶` æŒ‰é’®


**æ³¨æ„**: 
å¦‚æœè¯¥æ’ä»¶è¢«Chromeæµè§ˆå™¨ç¦ç”¨ï¼Œè¯·å°è¯• [ä»chrome web storeä¸‹è½½å®‰è£…]() æˆ–è€… [å®‰è£…æœªæ‰“åŒ…çš„æ’ä»¶]()

> This extension is not listed in the Chrome Web Store and may have been added without your knowledge.

#### å®‰è£…æœªæ‰“åŒ…çš„æ’ä»¶

1. ä¸‹è½½ [ç¨³å®šç‰ˆæœ¬](https://github.com/LouisYLWang/Sync-Sofa/archive/master.zip) or [å¼€å‘ç‰ˆæœ¬](https://github.com/LouisYLWang/Sync-Sofa/archive/dev.zip) (æ–°ç‰¹æ€§ï¼Œä¹Ÿè®¸ä¹Ÿæœ‰bug)
2. è§£å‹ä½ ä¸‹è½½çš„`.zip` å‹ç¼©æ–‡ä»¶
3. åœ¨Chromeåœ°å€æ è¾“å…¥ `chrome://extensions/` æ‰“å¼€æ’ä»¶ç®¡ç†é¡µé¢
4. å¼€å¯å³ä¸Šè§’`å¼€å‘è€…æ¨¡å¼` æŒ‰é’®
5. ç‚¹å‡»å·¦ä¸Šè§’`åŠ è½½æœªæ‰“åŒ…çš„æ‹“å±•` æŒ‰é’®
6. é€‰æ‹© `ä¸‹è½½è·¯å¾„/è§£å‹è·¯å¾„/client/chrome_extension`
7. ç‚¹å‡» `é€‰æ‹©`

#### å¾®è½¯Edgeæµè§ˆå™¨: 

#### ä»Edgeæµè§ˆå™¨æ’ä»¶ä¸­å¿ƒå®‰è£…

1. åœ¨Edgeæµè§ˆå™¨ä¸­æ‰“å¼€ [Sync Sofa - Online Video Synchronizer - Microsoft Edge Addons](https://microsoftedge.microsoft.com/addons/detail/kpfbclpafmmjalikjjlcoddffpfgghgp) 
2. ç‚¹å‡» `è·å–` æŒ‰é’®

### Firefox (åç»­ç‰ˆæœ¬æ·»åŠ æ”¯æŒ~~å…¶å®ä¹Ÿå¯èƒ½ä¸ä¼š~~) 

## æœåŠ¡ç«¯éƒ¨ç½²æŒ‡å—

**æ³¨æ„**:

âš ï¸ éƒ¨ç½²å‰ï¼Œå»ºè®®ä½ çš„æœåŠ¡å™¨å·²ç»éƒ¨ç½²äº†SSL/TLSè¯ä¹¦ï¼Œå¹¶å·²è¿æ¥åˆ°åŸŸåã€‚ä»¥ä¸‹éƒ¨ç½²è„šæœ¬åŸºäºä½¿ç”¨Let's Encrypt certificateséªŒè¯çš„æœåŠ¡å™¨ï¼Œå¦‚ä½¿ç”¨å…¶ä»–çš„è¯ä¹¦æä¾›å•†ï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹éƒ¨åˆ†è„šæœ¬ä»¥æ­£å¸¸è¿è¡Œã€‚

âš ï¸ devæ¨¡å¼ä½¿ç”¨httpåè®®è¿›è¡Œä¼ è¾“ï¼Œprodä½¿ç”¨httpsåè®®è¿›è¡Œä¼ è¾“

### ç›´æ¥éƒ¨ç½²ï¼ˆä¸ä½¿ç”¨Dockerå®¹å™¨ï¼‰:

**1. è·å–æ‰§è¡Œæ–‡ä»¶**

- å¦‚æœä½ æƒ³è¦ä¿®æ”¹æºä»£ç å¹¶è‡ªè¡Œç¼–è¯‘ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹shellè„šæœ¬è·å–äºŒè¿›åˆ¶æ–‡ä»¶ã€‚åœ¨æ‰§è¡Œå‰ï¼Œè¯·ç¡®è®¤æœåŠ¡å™¨å·²å®‰è£…`Go`çš„ç¯å¢ƒ

  ```shell
  go get github.com/LouisYLWang/Sync-Sofa/server
  # å¦‚æœä½ ä¸æ¸…æ¥š $GOPATH
  # è¯·å°è¯•è¾“å…¥å¹¶æ‰§è¡Œ "go env GOPATH"
  cd $GOPATH/src/github.com/LouisYLWang/Sync-Sofa/server

  # ï¼ˆä¸‹ä¸€æ­¥å¯çœç•¥ï¼‰
  # å¦‚æœä½ çœ‹åˆ°äº†è¿™æ¡æ¶ˆæ¯:
  # "dial tcp 216.58.200.49:443: i/o timeout"
  # è¯·æ·»åŠ å¹¶æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤
  export GOPROXY=https://goproxy.io

  go install
  cd $GOPATH/bin
  ```

- å¦‚æœæ— éœ€ä¿®æ”¹æºä»£ç å¹¶è‡ªè¡Œç¼–è¯‘ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶:
    1. æ‰“å¼€ [Github release page](https://github.com/LouisYLWang/Sync-Sofa/releases/latest)
    2. ä¸‹è½½ `server` æ–‡ä»¶ï¼ˆé€‚ç”¨äºlinuxæœåŠ¡å™¨ï¼‰
    3. ä¸‹è½½ `config.json` æ–‡ä»¶ï¼Œç§»åŠ¨è‡³`server`åŒä¸€è·¯å¾„

**2. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š**

- é…ç½®å˜é‡ï¼š

  - `addr`: æœåŠ¡å™¨ç«¯å£
  - `runmode`:
    - dev: å¼€å‘æ¨¡å¼ï¼ˆå»ºè®®æœ¬åœ°ä½¿ç”¨ï¼Œä¸åŒ…å«å¯¹HTTPSçš„æ”¯æŒï¼‰
    - prod: ç”Ÿäº§æ¨¡å¼
  - `tlsdir`:
    - `tlskey`: TLSè¯ä¹¦ç§é’¥è·¯å¾„ 
    - `tlscert`: TLSè¯ä¹¦è·¯å¾„ 

  **Notices**: `addr`, `runmode` ä¸ºå¿…é¡»å‚æ•°, `tlskey`, `tlscert` å‚æ•°åœ¨ä½¿ç”¨HTTPSè¿æ¥æ—¶ï¼ˆç”Ÿäº§ç¯å¢ƒä¸‹ï¼‰ä¸ºå¿…é¡»å‚æ•°

- å¼€å‘æ¨¡å¼ï¼ˆhttpï¼‰é…ç½®æ–‡ä»¶æ ·ä¾‹:

  ```json
  {
    "addr": ":80",
    "runmode": "dev"
  }
  ```

- ç”Ÿäº§æ¨¡å¼ï¼ˆhttpsï¼‰é…ç½®æ–‡ä»¶æ ·ä¾‹:
  ```json
  {
    "addr": ":443",
    "runmode": "prod",
    "tlsdir": {
      "tlskey": "/etc/letsencrypt/live/your.host.url/privkey.pem",
      "tlscert": "/etc/letsencrypt/live/your.host.url/fullchain.pem"
    }
  }

**3. åœ¨æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨è·¯å¾„ä¸‹ï¼Œæ‰§è¡Œ `./server` éƒ¨ç½²æœåŠ¡å™¨, éƒ¨ç½²æˆåŠŸä¿¡æ¯å¦‚ä¸‹:**


```
found config file, read parameters from config file...
server is listening at {your_port_number}...
```

### ä½¿ç”¨Dockerå®¹å™¨éƒ¨ç½²

åœ¨éƒ¨ç½²å‰è¯·ç¡®è®¤Dockerå®¹å™¨åœ¨æœåŠ¡å™¨ç«¯å¯æ­£å¸¸è¿è¡Œï¼Œè¯·æŒ‰ç…§å¦‚ä¸‹æç¤ºä¿®æ”¹å‚æ•°

- é…ç½®å˜é‡ï¼š
  - `ADDR`: æœåŠ¡å™¨ç«¯å£
  - `RUNMODE`:
    - dev: å¼€å‘æ¨¡å¼ï¼ˆå»ºè®®æœ¬åœ°ä½¿ç”¨ï¼Œä¸åŒ…å«å¯¹HTTPSçš„æ”¯æŒï¼‰
    - prod: ç”Ÿäº§æ¨¡å¼
  - `APIHOST`: æœåŠ¡å™¨ç½‘å€
  - `IMGNAME`: dockerå®¹å™¨åç§°ï¼ˆå¯è‡ªé€‰ï¼‰
  - `TLSKEYPATH`: TLSè¯ä¹¦ç§é’¥è·¯å¾„ 
  - `TLSCERTPATH`: TLSè¯ä¹¦è·¯å¾„ 

- å¼€å‘æ¨¡å¼ï¼ˆhttpï¼‰é…ç½®æ–‡ä»¶æ ·ä¾‹:

  ```sh
  docker pull louisylwang/watchtogether

  export ADDR=:4000 \      
  export RUNMODE=dev \   
  export IMGNAME=yourimagename \   

  docker run -d \
  -e ADDR=:4000 \
  -e RUNMODE=RUNMODE \
  -p 4000:4000 \
  --name IMGNAME louisylwang/watchtogether
  ```

- ç”Ÿäº§æ¨¡å¼ï¼ˆhttpsï¼‰é…ç½®æ–‡ä»¶æ ·ä¾‹:

  ```sh
  docker pull louisylwang/watchtogether

  export ADDR=:443 \      
  export RUNMODE=prod \   
  export APIHOST=your.host.name \   
  export IMGNAME=yourimagename \   
  export TLSKEYPATH=/your/path/to/TLS/privatekey \
  export TLSCERTPATH=/your/path/to/TLS/certification \


  docker run -d \
  -e ADDR=:ADDR \
  #docker port to server:server port to docker, not necessarily the same
  -p ADDR:ADDR \ 
  -e RUNMODE=RUNMODE \
  #if you use letsencrypt, TLSKEY value should be /etc/letsencrypt/live/$APIHOST/privkey.pem
  -e TLSKEY=TLSKEYPATH \ 
  #if you use letsencrypt, TLSCERT value should be /etc/letsencrypt/live/$APIHOST/fullchain.pem 
  -e TLSCERT=TLSCERTPATH \ 
  #need to expose your TLS certification file to docker
  -v /etc/letsencrypt:/etc/letsencrypt:ro \ 
  --name IMGNAME louisylwang/watchtogether \
  --restart=always
  ```


- éƒ¨ç½²æˆåŠŸåï¼Œæ‰§è¡Œ `docker logs {your docker image name}`å°†ä¼šæç¤ºä¸‹åˆ—æ—¥å¿—ä¿¡æ¯:

  ```
  not found config file, read parameters from system variables...
  YYYY/MM/DD HH:MM:SS server is listening at :ADDR...
  ```

## ç‰ˆæœ¬æ—¥å¿—

### v1.0.7
ğŸ›  2020å¹´7æœˆ5æ—¥æ›´æ–°
---
âš âš âš  æ³¨æ„ï¼Œæ­¤ç‰ˆæœ¬ä¸<= 1.0.5çš„ä»»ä½•ç‰ˆæœ¬éƒ½ä¸å…¼å®¹ï¼Œè¯·åŠ¡å¿…ç¡®ä¿ä½ çš„ç‰ˆæœ¬ä¸å°ä¼™ä¼´çš„ç‰ˆæœ¬ä¸€è‡´ã€‚

- æ–°å¢åŠŸèƒ½ï¼š
    - æ–°å¢ç‰ˆæœ¬æ£€æµ‹ï¼ˆé«˜ç‰ˆæœ¬ç”¨æˆ·ä¸ä½ç‰ˆæœ¬ç”¨æˆ·è¿æ¥æ—¶ï¼Œè‹¥è¿æ¥ç ç”±ä½ç‰ˆæœ¬ç”¨æˆ·ç”³è¯·ï¼Œé«˜ç‰ˆæœ¬ç”¨æˆ·å°†æ”¶åˆ°æç¤ºï¼Œè¯·æ ¹æ®æç¤ºå‘ŠçŸ¥å¯¹æ–¹å‡çº§æœ€æ–°ç‰ˆæœ¬ï¼‰
- ä¿®å¤åŠŸèƒ½:
    - ä¿®å¤å¯¹ [bilibili movie](https://www.bilibili.com/bangumi/*) çš„æ”¯æŒ
    - ä¿®å¤äº†ä¼˜é…·åŠèŠ’æœTVæ— æ³•åŒæ­¥æ“ä½œçš„é—®é¢˜


### v1.0.6
ğŸ›  2020å¹´6æœˆ28æ—¥æ›´æ–°
---
âš âš âš  æ³¨æ„ï¼Œæ­¤ç‰ˆæœ¬ä¸ä¹‹å‰çš„ä»»ä½•ç‰ˆæœ¬éƒ½ä¸å…¼å®¹ï¼Œè¯·åŠ¡å¿…ç¡®ä¿ä½ çš„ç‰ˆæœ¬ä¸å°ä¼™ä¼´çš„ç‰ˆæœ¬ä¸€è‡´ã€‚


- æ–°å¢åŠŸèƒ½ï¼š
    - æ”¯æŒèŠ’æœTVï¼ˆæ¥ä¹˜é£ç ´æµªå§ï¼ğŸ¤£ï¼‰
    - æ”¯æŒä½¿ç”¨VLCæ’­æ”¾å™¨åŒæ­¥æ’­æ”¾æœ¬åœ°è§†é¢‘æ–‡ä»¶
    - æ–°å¢è®¾ç½®é¡µé¢-è°ƒè¯•æ¨¡å¼
    - æ–°å¢æèµ é¡µé¢
    - æ–°å¢wikié¡µé¢
- ä¿®å¤åŠŸèƒ½:
    - æé«˜åŒæ­¥çš„ç¨³å®šæ€§:
      - æ›´æ–°äº†åŒæ­¥é€»è¾‘ï¼ˆä¸ä¸ä¹‹å‰çš„ä»»ä½•ç‰ˆæœ¬å…¼å®¹ï¼Œè¯·å°½å¿«æ›´æ–°è‡³1.0.6+ï¼‰
      - å¢åŠ ç¼“å†²æ£€æµ‹

### v1.0.5
ğŸ›  2020å¹´5æœˆ12æ—¥æ›´æ–°
---
- æ–°å¢åŠŸèƒ½ï¼š
    - å¢åŠ å¯¹Edgeæµè§ˆå™¨çš„æ”¯æŒ
- ä¿®å¤åŠŸèƒ½ï¼š
    - æé«˜åŒæ­¥çš„ç¨³å®šæ€§


### v1.0.4
ğŸ›  2020å¹´5æœˆ10æ—¥æ›´æ–°
---
- æ–°å¢åŠŸèƒ½ï¼š
    - æ–°å¢æˆåŠŸè¿æ¥æç¤º
- ä¿®å¤åŠŸèƒ½ï¼š
    - æé«˜åŒæ­¥çš„ç¨³å®šæ€§
    - ä¿®æ”¹æ¶ˆæ¯å¼¹çª—æ ·å¼

### v1.0.3
ğŸ›  2020å¹´5æœˆ8æ—¥æ›´æ–°
---

- æ–°å¢åŠŸèƒ½ï¼š
    - æ–°å¢å¯¹ä»¥ä¸‹è§†é¢‘ç½‘ç«™çš„æ”¯æŒ
      - [çˆ±å¥‡è‰º](https://www.iqiyi.com/) 
      - [ä¼˜é…·](https://www.youku.com/)
      - [å¾®äº‘](https://www.weiyun.com/)
      - [è…¾è®¯è§†é¢‘](https://v.qq.com/)
- ä¿®å¤åŠŸèƒ½ï¼š
    - æé«˜åŒæ­¥çš„ç¨³å®šæ€§
    - ä¿®æ”¹æ–‡æ¡£

### v1.0.2
ğŸ›  2020å¹´3æœˆ31æ—¥æ›´æ–°
---
- æ–°å¢åŠŸèƒ½ï¼š
    - æ”¯æŒå¯¹ä¿®æ”¹æ’­æ”¾è¿›åº¦çš„åŒæ­¥
- ä¿®å¤åŠŸèƒ½ï¼š
    - æé«˜åŒæ­¥çš„ç¨³å®šæ€§

### v0.0.1
ğŸ›  2020å¹´3æœˆ26æ—¥æ›´æ–° (æµ‹è¯•ç‰ˆ)
---
- æ–°å¢åŠŸèƒ½ï¼š
    - æ”¯æŒæ’­æ”¾æš‚åœåŒæ­¥
    - æ”¯æŒæ–­å¼€è¿æ¥æç¤º

## å¼€å‘è€…

Yiliang "Louis" Wang â€“ [@blog](https://ylwang.codes/) â€“ [@mail](mailto:louis.yl.wang@outlook.com)

Onns â€“ [@blog](https://onns.xyz/) â€“ [@mail](mailto:onns@onns.xyz)

## Contributing

1. Fork it (<https://github.com/LouisYLWang/Sync-Sofa/fork>)
2. Create your feature branch (`git checkout -b feature/fooBar`)
3. Commit your changes (`git commit -am 'Add some fooBar'`)
4. Push to the branch (`git push origin feature/fooBar`)
5. Create a new Pull Request

<!-- Markdown link & img dfn's -->

[chrome-image]: https://img.shields.io/chrome-web-store/users/kgpnhgmpijhpkefpddoehhminpfiddmg?style=flat-square
[chrome-url]: https://chrome.google.com/webstore/detail/sync-sofa-beta-online-vid/kgpnhgmpijhpkefpddoehhminpfiddmg

## å¸¸è§é—®é¢˜
1. **Q:** åœ¨æˆ‘å®‰è£…çš„æ—¶å€™ï¼ŒChromeæç¤ºæˆ‘Sync Sofaå¯ä»¥`è¯»å–å’Œæ›´æ”¹æ‚¨åœ¨ä¸€äº›ç½‘ç«™ä¸Šçš„æ•°æ®`ä»¥åŠ`è¯»å–æ‚¨çš„æµè§ˆè®°å½•`ï¼Œå¬èµ·æ¥å¾ˆä¸¥é‡ï¼Œå®ƒå®‰å…¨å—ï¼Ÿ
    
    **A:** æˆ‘ä»¬ä¸ä¼šæ”¶é›†ä½ çš„æµè§ˆæ•°æ®ï¼Œæˆ‘ä»¬åªä¼šè¯»å–ä½ å½“å‰æ ‡ç­¾é¡µçš„æ ‡é¢˜ï¼Œç”¨æ¥åˆ¤æ–­ä½ æ˜¯å¦åœ¨è®¿é—®æˆ‘ä»¬æ”¯æŒçš„é¡µé¢([æ”¯æŒç½‘ç«™åˆ—è¡¨](#supported-list))ï¼Œä»¥é¿å…å½±å“ä½¿ç”¨ä½“éªŒçš„äº‹æƒ…å‘ç”Ÿã€‚æ‰€æœ‰å¯¹ä½ æµè§ˆæ•°æ®çš„æ”¶é›†å’Œå¤„ç†åªä¼šå‘ç”Ÿåœ¨æœ¬åœ°ï¼›äº‹å®ä¸Šæˆ‘ä»¬ä¹Ÿä¸ä¼šéšæ„ä¿®æ”¹ç½‘ç«™çš„æ•°æ®ï¼Œæˆ‘ä»¬åªä¼šä½¿ç”¨ä¸€ä¸ªåŒæ­¥è„šæœ¬æ¥ç›‘æµ‹ä½ æ’­æ”¾ï¼Œæš‚åœåŠæ›´æ–°è¿›åº¦ç­‰æ“ä½œï¼ˆæˆ‘ä»¬ä¸å¾—ä¸è¿™æ ·åšï¼‰ã€‚**æ‰€æœ‰çš„æºç éƒ½å¯ä»¥åœ¨ [æˆ‘ä»¬çš„é¡¹ç›®ä¸»é¡µ]å®¡æ ¸(https://github.com/LouisYLWang/Sync-Sofa), æˆ‘ä»¬æ‰¿è¯ºç›®å‰åšçš„æ‰€æœ‰äº‹æƒ…éƒ½æ˜¯å¿…è¦ä¸”æ— å®³çš„.**

2. å¦‚æœä½ å‘ç°**æŒ‰é’®å˜ç°**, è¯·ç¡®è®¤ä½ æ˜¯å¦åœ¨æˆ‘ä»¬æ”¯æŒçš„ç½‘ç«™æ“ä½œ([æ”¯æŒç½‘ç«™åˆ—è¡¨](#supported-list)).

3. å¦‚æœä½ å‘ç°æ’ä»¶**æ— æ³•è·å–åŒæ­¥ç **ï¼Œè¯·æŒ‰ä»¥ä¸‹é¡ºåºæ£€æŸ¥é—®é¢˜ï¼š
    1. è¯·æ£€æŸ¥ [é€‰é¡¹é¡µé¢](#options-page) å¹¶ç‚¹å‡»`é‡ç½®` æŒ‰é’®
    2. è¯·å‚è€ƒ [é€‰é¡¹é¡µé¢](#options-page) æ ¹æ®ä½ æ‰€åœ¨çš„ä½ç½®é€‰æ‹©å¹¶è®¾ç½®åˆé€‚çš„æœåŠ¡å™¨
    3. è¯·æ£€æŸ¥æœåŠ¡å™¨å½“å‰çŠ¶æ€ [https://sync-status.onns.xyz/](https://sync-status.onns.xyz/)æ˜¯å¦æ­£å¸¸å¯åŠ¨
    4. å¦‚ä»¥ä¸Šéƒ½ä¸èƒ½è§£å†³ä½ çš„é—®é¢˜ï¼Œè¯·é€šè¿‡[é¡¹ç›®åé¦ˆé¡µé¢](https://github.com/LouisYLWang/Sync-Sofa/issues)æˆ–[é¡¹ç›®wikié¡µé¢](https://onns.xyz/sync-sofa/)å³ä¸‹è§’çš„åé¦ˆæŒ‰é’®é€šçŸ¥æˆ‘ä»¬ã€‚


4. å¦‚æœä½ å‘ç°æ’ä»¶**æ— æ³•æ­£å¸¸åŒæ­¥æ“ä½œ**ï¼Œè¯·æŒ‰ä»¥ä¸‹é¡ºåºæ£€æŸ¥é—®é¢˜ï¼š
    1. è¯·åŠ¡å¿…ç¡®è®¤ä¸¤æ–¹ç‰ˆæœ¬å·æ˜¯å¦ä¸€è‡´ï¼Œæ¬²æ£€æµ‹ç‰ˆæœ¬å·ï¼Œéœ€æ‰“å¼€[chrome extension page](chrome://extensions/)ï¼Œå¹¶æ‰¾åˆ°`Sync Sofa - Online Video Synchronizer *.*.*`ï¼Œå…¶ä¸­ `*.*.*` ä¸ºå½“å‰ç‰ˆæœ¬ã€‚
    2. è¯·æ£€æŸ¥ [é€‰é¡¹é¡µé¢](#options-page) å¹¶ç‚¹å‡»`é‡ç½®` æŒ‰é’®
    3. è¯·å‚è€ƒ [é€‰é¡¹é¡µé¢](#options-page) æ ¹æ®ä½ æ‰€åœ¨çš„ä½ç½®é€‰æ‹©å¹¶è®¾ç½®åˆé€‚çš„æœåŠ¡å™¨
    4. è¯·æ£€æŸ¥æœåŠ¡å™¨å½“å‰çŠ¶æ€ [https://sync-status.onns.xyz/](https://sync-status.onns.xyz/)æ˜¯å¦æ­£å¸¸å¯åŠ¨.
    5. å¦‚ä»¥ä¸Šéƒ½ä¸èƒ½è§£å†³ä½ çš„é—®é¢˜ï¼Œè¯·é€šè¿‡[é¡¹ç›®åé¦ˆé¡µé¢](https://github.com/LouisYLWang/Sync-Sofa/issues)æˆ–[é¡¹ç›®wikié¡µé¢](https://onns.xyz/sync-sofa/)å³ä¸‹è§’çš„åé¦ˆæŒ‰é’®é€šçŸ¥æˆ‘ä»¬ã€‚



